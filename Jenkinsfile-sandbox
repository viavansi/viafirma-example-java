pipeline {
    agent {
        node {
            label 'registry'
        }
    }
    stages {
        stage('Git clone'){
            steps{
                git branch:"sandbox" ,url: 'git@github.com:viavansi/viafirma-platform-example-java.git'
            }
        }
        // Launch compile and sonar
        stage('Build'){
            steps{
                sh 'build.sh sandbox'
             }
        }

        stage('Deploy'){
            steps{
                sh "deploy.sh sandbox"
            }
        }
    }
    post {
        always {
            archiveArtifacts artifacts: '**/*.jar', onlyIfSuccessful: true, fingerprint: true
        }
    }
}
