pipeline {
    agent {
        node {
            label 'registry'
        }
    }
    stages {
        stage('Git clone'){
            steps{
                git branch:"ci" ,url: 'git@github.com:viavansi/viafirma-platform-example-java.git'
            }
        }
        // Launch compile and sonar
        stage('Build'){
            steps{
                sh "ls -al"
                sh "./build.sh ci"
             }
        }

        stage('Deploy'){
            steps{
                sh "./deploy.sh ci"
            }
        }
    }
    post {
        always {
            archiveArtifacts artifacts: '**/*.jar', onlyIfSuccessful: true, fingerprint: true
        }
    }
}
